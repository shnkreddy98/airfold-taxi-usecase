nodes:
  - seasonal_trends:
      sql: |
        SELECT 
            dt.year,
            dt.month,
            COUNT(*) as trip_count,
            SUM(ft.trip_miles) as total_miles,
            AVG(ft.base_passenger_fare) as avg_fare
        FROM fact_trips ft
        JOIN dim_time dt ON ft.pickup_time_id = dt.full_datetime
        GROUP BY dt.year, dt.month
        ORDER BY dt.year, dt.month
publish: seasonalTrends
